# Cybersecurity Case Study: Chapter 6 - Requirements

## 6.1 Requirements Gathering Process

The requirements for "Project Sentinel" are derived from three primary sources:
1.  **Analysis of Past Incidents:** Reviewing historical security incidents to define the specific patterns of data exfiltration we need to detect.
2.  **SOC Analyst Expertise:** Interviewing senior Security Operations Center (SOC) analysts to understand their current workflows, pain points, and requirements for a monitoring and override system.
3.  **Exploratory R&D:** The R&D process itself will uncover new requirements as the team discovers what is technically feasible.

## 6.2 System Actors

The key actors in this system include both human and non-human entities:
-   **SOC Analyst:** The human user who monitors the system's performance, investigates high-priority alerts, and has the authority to override autonomous actions.
-   **Data Collection Agent:** An autonomous software component deployed in the target environment to gather and stream data.
-   **Analysis Engine:** The centralized AI-powered component that processes data and makes decisions.
-   **Response Agent:** An autonomous software component that executes actions in the target environment based on commands from the Response Engine.

## 6.3 Functional Requirements (System Capabilities)

### Data Collection
-   The Data Collection Agent must be able to securely stream AWS VPC flow logs to the central data pipeline in near real-time.
-   The agent must have a minimal performance footprint on the host systems.
-   The data stream must include source/destination IP, port, protocol, packet/byte counts, and timestamp.

### Data Analysis
-   The Analysis Engine must be able to process the incoming data stream at a rate of at least 100,000 events per second.
-   The engine must apply the trained ML model to score each network flow for data exfiltration patterns.
-   When a threat is detected with a confidence score above a predefined threshold (e.g., 95%), the engine must generate a high-fidelity alert and pass it to the Response Engine.

### Response
-   The Response Engine must be able to receive alerts and translate them into specific, pre-authorized actions.
-   For the MVP, the only authorized action is `quarantine_instance`.
-   The Response Agent must be able to receive the `quarantine_instance` command and apply a "Quarantine" security group to the specified EC2 instance within 10 seconds.

### Monitoring & Control (SOC Dashboard)
-   **As a** SOC Analyst, **I want to** see a real-time feed of all high-confidence alerts generated by the system, **so that** I can maintain situational awareness.
-   **As a** SOC Analyst, **I want to** view a detailed audit trail for any automated response, showing what was detected and what action was taken, **so that** I can conduct a post-incident review.
-   **As a** SOC Analyst, **I want to** have a "big red button" to disable the autonomous response capability system-wide immediately, **so that** I can intervene in case of unexpected behavior.
-   **As a** SOC Analyst, **I want to** be able to manually approve or reject a pending response for alerts with a medium confidence score, **so that** I can act as a human-in-the-loop for ambiguous cases.

## 6.4 Non-Functional Requirements

For Project Sentinel, the non-functional requirements are mission-critical.
-   **Performance:**
    -   **Time-to-Detect:** The system must detect a threat within **1 minute** of the malicious activity starting.
    -   **Time-to-Respond:** The system must execute a response within **5 minutes** of the initial detection.
-   **Accuracy:**
    -   **False Positive Rate:** Must be below **0.1%**. A higher rate would create too much noise and disrupt legitimate business operations.
    -   **False Negative Rate:** Must be minimized and continuously tracked.
-   **Security:**
    -   All communication between agents and the central platform must be encrypted using mTLS (mutual TLS).
    -   The agents themselves must be tamper-proof and have the absolute minimum permissions required to perform their functions (Principle of Least Privilege).
    -   The control plane must be protected by multi-factor authentication for all human access.
-   **Auditability:**
    -   Every decision made by the Analysis Engine and every action taken by a Response Agent must be logged to a secure, immutable log store (e.g., AWS Quantum Ledger Database).
-   **Reliability:**
    -   The system must be designed for high availability (99.99%) with no single point of failure.
